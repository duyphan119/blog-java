<aside
  th:fragment="aside"
  class="main-sidebar sidebar-dark-primary elevation-4"
>
  <!-- Brand Logo -->
  <a href="index3.html" class="brand-link">
    <img
      th:src="@{/assets/dist/img/AdminLTELogo.png}"
      alt="AdminLTE Logo"
      class="brand-image img-circle elevation-3"
      style="opacity: 0.8"
    />
    <span class="brand-text font-weight-light">AdminLTE 3</span>
  </a>

  <!-- Sidebar -->
  <div class="sidebar">
    <!-- Sidebar user panel (optional) -->
    <a
      th:href="@{/admin/profile}"
      class="user-panel"
      style="margin: 1rem; display: flex; padding-bottom: 1rem"
    >
      <img
        th:src="@{/assets/dist/img/user2-160x160.jpg}"
        class="img-circle elevation-2"
        alt="User Image"
        id="userImage"
        width="34px"
        height="34px"
        style="object-fit: cover; border-radius: 50%"
      />
      <div
        style="display: none"
        sec:authorize="isAuthenticated()"
        id="userImageText"
      >
        <th:block sec:authentication="principal.user.imageUrl"></th:block>
      </div>
      <script>
        const userImageTextElm = document.getElementById("userImageText");
        document.getElementById("userImage").src = userImageTextElm.textContent;
        userImageTextElm.parentNode.removeChild(userImageTextElm);
      </script>
      <div class="info" sec:authorize="isAuthenticated()">
        <th:block sec:authentication="principal.user.firstName"></th:block>
        <th:block sec:authentication="principal.user.lastName"></th:block>
      </div>
    </a>

    <!-- SidebarSearch Form -->
    <div class="form-inline">
      <div class="input-group" data-widget="sidebar-search">
        <input
          class="form-control form-control-sidebar"
          type="search"
          placeholder="Search"
          aria-label="Search"
        />
        <div class="input-group-append">
          <button class="btn btn-sidebar">
            <i class="fas fa-search fa-fw"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- Sidebar Menu -->
    <nav class="mt-2">
      <ul
        class="nav nav-pills nav-sidebar flex-column"
        data-widget="treeview"
        role="menu"
        data-accordion="false"
      >
        <!-- Add icons to the links using the .nav-icon class
             with font-awesome or any other icon font library -->
        <li class="nav-item">
          <a th:href="@{/admin}" class="nav-link">
            <i class="nav-icon fas fa-tachometer-alt"></i>
            <p>Trang chủ</p>
          </a>
        </li>
        <li class="nav-item">
          <a th:href="@{/admin/category}" class="nav-link">
            <i class="nav-icon fas fa-tachometer-alt"></i>
            <p>Danh mục</p>
          </a>
        </li>
        <li class="nav-item">
          <a th:href="@{/admin/article}" class="nav-link">
            <i class="nav-icon fas fa-tachometer-alt"></i>
            <p>Bài viết</p>
          </a>
        </li>
      </ul>
      <script>
        function activeSideNav() {
          let currentPath = window.location.pathname;
          let navLinks = document.querySelectorAll(".nav-item a");
          let isActiveSetted = false;
          let max = 0;
          let indexMax = 0;
          function isMatched(path, current) {
            if (current.startsWith(path)) return path.length;
            return 0;
          }
          navLinks.forEach(function (link, index) {
            if (index !== 0) {
              let linkPath = link.getAttribute("href");
              const length = isMatched(linkPath, currentPath);
              if (length >= max) {
                max = length;
                indexMax = index;
              }
            }
          });
          navLinks[indexMax].classList.add("active");
        }
        activeSideNav();
      </script>
    </nav>
    <!-- /.sidebar-menu -->
  </div>
  <!-- /.sidebar -->
</aside>
